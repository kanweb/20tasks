<?php
session_start(); // Запускаем сессию

// Данные для подключения к базе данных
$host = "MySQL-8.0"; // Имя сервера базы данных
$username = "root"; // Имя пользователя базы данных
$password = ""; // Пароль пользователя базы данных
$database = "database_name"; // Имя базы данных
// Функция для подключения к базе данных
function dbConnect()
{
    global $host, $username, $password, $database; // Получаем доступ к глобальным переменным
    $conn = mysqli_connect($host, $username, $password, $database); // Подключаемся к базе данных
    if (!$conn) { // Если подключение не удалось...
        die("Connection failed: " . mysqli_connect_error()); // ...выводим сообщение об ошибке и завершаем скрипт
    }
    return $conn; // Возвращаем объект соединения
}

// Функция для удаления расхода из базы данных
function deleteExpense($id)
{
    $conn = dbConnect(); // Подключаемся к базе данных
    $sql = "DELETE FROM expenses WHERE id = $id"; // Формируем SQL-запрос для удаления расхода
    if (mysqli_query($conn, $sql)) { // Выполняем запрос
        return true; // Возвращаем true, если запрос выполнен успешно
    } else {
        return false; // Возвращаем false, если произошла ошибка
    }
}

// Проверяем, передан ли ID расхода
if (isset($_GET['id'])) { // Если ID расхода передан...
    $id = $_GET['id']; // ...получаем его из GET-параметра

    // Удаляем расход из базы данных
    if (deleteExpense($id)) { // Если расход успешно удален...
        $_SESSION['success'] = 'Расход успешно удален!'; // ...создаем сообщение об успехе в сессии
    } else {
        $_SESSION['error'] = 'Ошибка при удалении расхода!'; // ...создаем сообщение об ошибке в сессии
    }

    header('Location: task9.php'); // Перенаправляем пользователя обратно на страницу с формой
    exit; // Завершаем скрипт
} else {
    $_SESSION['error'] = 'Не передан ID расхода!'; // Создаем сообщение об ошибке в сессии
    header('Location: task9.php'); // Перенаправляем пользователя обратно на страницу с формой
    exit; // Завершаем скрипт
}